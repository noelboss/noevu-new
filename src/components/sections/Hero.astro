---
import type { HeroSection } from '../../schemas/sections';

interface Props {
  data: HeroSection;
}

const { data } = Astro.props;
const {
  headline,
  subheadline,
  description,
  image,
  backgroundImage,
  ctas,
  rating,
  alignment = 'left',
} = data;

const alignmentClass = `hero--${alignment}`;
---

<section class={`hero ${alignmentClass}`}>
  {backgroundImage && (
    <div class="hero__background">
      <img
        src={backgroundImage.src}
        alt={backgroundImage.alt}
        loading="eager"
        class="hero__background-image"
      />
    </div>
  )}

  <div class="hero__container container">
    <div class="hero__content">
      {subheadline && <p class="hero__subheadline">{subheadline}</p>}
      <h1 class="hero__headline">{headline}</h1>
      {description && <div class="hero__description" set:html={description} />}

      {ctas && ctas.length > 0 && (
        <div class="hero__ctas">
          {ctas.map((cta, index) => (
            <a
              href={cta.href}
              class={`btn ${index === 0 ? 'btn--primary' : 'btn--secondary'}`}
              target={cta.external ? '_blank' : undefined}
              rel={cta.external ? 'noopener noreferrer' : undefined}
            >
              {cta.label}
            </a>
          ))}
        </div>
      )}

      {rating && (
        <div class="hero__rating">
          <div class="hero__rating-stars" aria-label={`${rating.score} von 5 Sternen`}>
            {Array.from({ length: 5 }).map((_, i) => (
              <svg
                class={`hero__star ${i < Math.floor(rating.score) ? 'hero__star--filled' : ''}`}
                viewBox="0 0 20 20"
                fill="currentColor"
                aria-hidden="true"
              >
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
              </svg>
            ))}
          </div>
          <span class="hero__rating-text">
            {rating.score} ({rating.count} {rating.label || 'Bewertungen'})
          </span>
        </div>
      )}
    </div>

    {image && (
      <div class="hero__image">
        <img
          src={image.src}
          alt={image.alt}
          width={image.width}
          height={image.height}
          loading="eager"
        />
      </div>
    )}
  </div>
</section>

<style>
  .hero {
    position: relative;
    padding-block: var(--section-spacing-lg);
    overflow: hidden;
  }

  .hero__background {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .hero__background::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(248, 247, 244, 0.85) 0%, rgba(248, 247, 244, 0.4) 60%, transparent 100%);
    pointer-events: none;
  }

  .hero__background-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: right center;
  }

  .hero__container {
    position: relative;
    z-index: 1;
    display: grid;
    gap: var(--space-12);
    align-items: center;
  }

  @media (min-width: 1024px) {
    .hero__container {
      grid-template-columns: 1fr 1fr;
    }
  }

  .hero__content {
    max-width: 600px;
  }

  .hero--center .hero__content {
    text-align: center;
    margin-inline: auto;
    max-width: 800px;
  }

  .hero__subheadline {
    font-size: var(--text-lg);
    color: var(--color-primary);
    font-weight: var(--font-medium);
    margin-bottom: var(--space-4);
  }

  .hero__headline {
    font-size: var(--text-5xl);
    font-family: var(--font-display);
    font-weight: var(--font-normal); /* Abril Fatface is always 400 */
    line-height: var(--leading-tight);
    margin-bottom: var(--space-6);
  }

  .hero__description {
    font-size: var(--text-lg);
    color: var(--color-text-muted);
    margin-bottom: var(--space-8);
  }

  .hero__ctas {
    display: flex;
    flex-wrap: wrap;
    gap: var(--space-4);
    margin-bottom: var(--space-8);
  }

  .hero--center .hero__ctas {
    justify-content: center;
  }

  .hero__rating {
    display: flex;
    align-items: center;
    gap: var(--space-3);
  }

  .hero--center .hero__rating {
    justify-content: center;
  }

  .hero__rating-stars {
    display: flex;
    gap: var(--space-1);
  }

  .hero__star {
    width: 1.25rem;
    height: 1.25rem;
    color: var(--color-neutral-300);
  }

  .hero__star--filled {
    color: var(--color-accent);
  }

  .hero__rating-text {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
  }

  .hero__image img {
    border-radius: var(--radius-lg);
    box-shadow: var(--shadow-lg);
  }
</style>
